"use strict";(self.webpackChunkuimotelndefined=self.webpackChunkuimotelndefined||[]).push([[7729],{9375:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"developers/two_verify/template_sms","title":"Template Sms","description":"Given the variety of SMS services, Simotel provides a scalable infrastructure for sending messages, allowing you to use your preferred service. Below is an example of an SMS sending service, and you can modify the following Python code to upload the service in Simotel.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/developers/6-two_verify/2-template_sms.md","sourceDirName":"developers/6-two_verify","slug":"/developers/two_verify/template_sms","permalink":"/wiki.test/developers/two_verify/template_sms","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Template Sms"},"sidebar":"docs","previous":{"title":"What is","permalink":"/wiki.test/developers/two_verify/whatis"},"next":{"title":"Service Activation","permalink":"/wiki.test/developers/two_verify/service_activate"}}');var t=s(4848),i=s(8453);const o={sidebar_position:1,title:"Template Sms"},a="SMS Sending Service Template",d={},p=[{value:"Description",id:"description",level:3},{value:"Example Code",id:"example-code",level:3},{value:"Testing",id:"testing",level:3},{value:"Logging",id:"logging",level:3}];function m(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"sms-sending-service-template",children:"SMS Sending Service Template"})}),"\n",(0,t.jsx)(n.p,{children:"Given the variety of SMS services, Simotel provides a scalable infrastructure for sending messages, allowing you to use your preferred service. Below is an example of an SMS sending service, and you can modify the following Python code to upload the service in Simotel."}),"\n",(0,t.jsx)(n.h1,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-py",children:'\r\n# Define module parameters for the SMS service\r\nmodule_param = {"username": "my_sername", "password": "my_pass", "src": "my_src_number"}\r\n\r\nimport sys\r\nimport base64\r\nimport requests\r\n\r\ndef send_message(phone_number, message):\r\n    """\r\n    Send an SMS message via a specified service provider (in this case, ippanel).\r\n    \r\n    IMPORTANT: \r\n    If you are using a different SMS service provider, you will need to modify this function\r\n    to meet the specific requirements and API specifications of your chosen provider.\r\n    \r\n    Args:\r\n    - phone_number (str): The phone number to send the SMS to.\r\n    - message (str): The content of the SMS message.\r\n    \r\n    Returns:\r\n    None\r\n    """\r\n    \r\n    # URL for the ippanel SMS API\r\n    url = \'http://ippanel.com/api/select\'\r\n    # Construct the payload with provided parameters and arguments\r\n    data = {\r\n        "op": "send",\r\n        "uname": module_param["username"],\r\n        "pass": module_param["password"],\r\n        "message": message,\r\n        "from": module_param["src"],\r\n        "to": [phone_number]\r\n    }\r\n    \r\n    # Send the request to the ippanel service\r\n    response = requests.post(url, json=data)\r\n\r\n    # Check the response and print appropriate messages\r\n    if response.status_code == 200:\r\n        print(response)\r\n    else:\r\n        print("whatever you want")\r\n\r\n# Check the number of arguments provided\r\n# If there are 3 arguments, decode the phone number and message from base64\r\nif len(sys.argv) == 3:\r\n    phone_number = base64.b64decode(sys.argv[1]).decode("utf-8")\r\n    message = base64.b64decode(sys.argv[2]).decode("utf-8")\r\n    send_message(phone_number, message)\r\n    print("sending message %s to %s" % (message, phone_number))\r\n    \r\n# If there are 4 arguments, check if the last argument is "test"\r\nelif len(sys.argv) == 4:\r\n    # this part is just for test your sms service command sample: python3.8 simotel_sms_service_template.py "0915xxxxxxx" "my_message" test\r\n    phone_number = sys.argv[1]\r\n    message = sys.argv[2]\r\n    if sys.argv[3] == "test":\r\n        send_message(phone_number, message)\r\n        print("sending message %s to %s" % (message, phone_number))\r\n    else:\r\n        print("invalid command")\r\nelse:\r\n    # If the number of arguments doesn\'t match expected values, print an error message\r\n    print(sys.argv)\r\n    print("unable to get message")\r\n\n'})}),"\n",(0,t.jsx)(n.h3,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["In the above template, there is a function named ",(0,t.jsx)(n.code,{children:"send_message"})," that is responsible for sending the SMS. The only part that needs to be changed is the configuration for your SMS service provider. This function accepts two parameters: ",(0,t.jsx)(n.code,{children:"phone_number"})," (the recipient's number) and ",(0,t.jsx)(n.code,{children:"message"})," (the content of the SMS). The rest of the code is up to you to implement, where you will call your SMS service provider using these parameters (you can refer to the provider's documentation for this)."]}),"\n",(0,t.jsx)(n.h3,{id:"example-code",children:"Example Code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import requests\r\n\r\n# Define the API endpoint and API key\r\napi_endpoint = "https://your-sms-service.com/send_sms"\r\napi_key = "your_api_key"\r\n\r\n# Send message function\r\ndef send_message(phone_number, message):\r\n    # Prepare the payload\r\n    payload = {\r\n        \'to\': phone_number,\r\n        \'message\': message,\r\n        \'from\': \'your_sender_id\',  # This part depends on your SMS provider\'s configuration\r\n        \'api_key\': api_key\r\n    }\r\n\r\n    # Send POST request to the API\r\n    try:\r\n        response = requests.post(api_endpoint, data=payload)\r\n        # Check response status\r\n        if response.status_code == 200:\r\n            print("Message sent successfully!")\r\n        else:\r\n            print(f"Message sending failed. Error: {response.status_code}, {response.text}")\r\n    except Exception as e:\r\n        print(f"Error in sending message: {str(e)}")\r\n\r\n# Test the function\r\nif __name__ == "__main__":\r\n    phone_number = "0915xxxxxxx"  # Recipient\'s phone number\r\n    message = "your_message_content_here"  # Message content\r\n    send_message(phone_number, message)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.p,{children:"To test the code, first upload it to the Simotel server and then execute it using the following command in the Linux shell:"}),"\n",(0,t.jsx)(n.p,{children:"This will send the message to the specified phone number with the provided message content. If there are any issues with sending the message, the errors will be displayed."}),"\n",(0,t.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,t.jsxs)(n.p,{children:["Any output you ",(0,t.jsx)(n.code,{children:"print()"})," in this file will be visible in the ",(0,t.jsx)(n.code,{children:"/usr/src/simotel/simotelhelper.log"})," file. It is recommended to print the response of the SMS service call to help track any issues. For example:"]})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(6540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);