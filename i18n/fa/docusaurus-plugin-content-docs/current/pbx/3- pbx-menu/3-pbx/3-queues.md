---
sidebar_label: "صف ها"
title: "صف ها"
---


# صف ها

:::info اطلاعات  
یکی از امکانات مهم سیستم‌های تلفنی، صف است. صف با ارائه استراتژی‌های متفاوت، قابلیت توزیع مناسب تماس در میان اپراتورها را فراهم می‌آورد.  
:::

## پارامترهای صف  

- **Name**: نام صف.  

- **Number**: شماره داخلی صف را مشخص می‌کند. از این شماره برای انتقال تماس و یا وارد کردن یک تماس به داخل صف استفاده می‌شود و اپراتورها نیز برای وارد شدن و خارج شدن از صف، این شماره را شماره‌گیری می‌کنند. برای مثال، اگر شماره صف ۳۴۵ باشد و کد ورود به صف `#` و کد خروج از صف `##` باشد، اپراتورها برای وارد شدن به صف، `۳۴۵#` و برای خارج شدن از صف، `۳۴۵##` را شماره‌گیری می‌کنند.

- **Ring Strategy**: استراتژی‌های وصل کردن تماس‌های ورودی به اپراتورهای صف مطابق زیر است.  

	- **Ringall**: تمام اپراتورهای صف با هم زنگ می‌خورند (پیش‌فرض). این استراتژی یک الگوریتم توزیع تماس واقعی به حساب نمی‌آید. در شبکه‌های تلفنی مرسوم، این روش تماس گروهی نامیده می‌شود.  

	- **Leastrecent**: تماس به سمت اپراتورهایی ارسال می‌شود که اخیراً کمترین تماس را پاسخ داده‌اند. این استراتژی در صف‌هایی که تماس‌های زیادی با مدت مکالمه تقریباً یکسان دارند، کاربرد دارد. این استراتژی در شرایطی که مثلاً یک اپراتور برای یک ساعت در حال مکالمه باشد و آخرین تماس همکارانش نیم ساعت قبل بوده باشد، به‌خوبی کار نمی‌کند، زیرا اپراتوری که به‌تازگی تماس یک‌ساعته‌اش تمام شده باشد، تماس بعدی را نیز دریافت می‌کند.  

	- **Fewestcalls**: اپراتورهایی که تعداد تماس کامل کمتری داشته باشند، در اولویت قرار می‌گیرند. این استراتژی در صف‌هایی که مدت مکالمه تماس‌هایش همیشه یکسان نیست، ناعادلانه است. یک اپراتور ممکن است سه تماس پانزده‌دقیقه‌ای و همکارش چهار تماس پنج‌ثانیه‌ای را جواب داده باشد. اپراتوری که سه تماس داشته است، تماس بعدی را دریافت می‌کند.  

	- **Random**: تماس‌ها به‌صورت تصادفی به یکی از اپراتورها وصل می‌شوند. این استراتژی عملاً تماس‌ها را به‌گونه‌ای توزیع می‌کند که نتیجه آن منصفانه باشد.

	- **RR Memory**: اپراتورها به روش ترتیبی-چرخشی تماس‌ها را جواب می‌دهند. این استراتژی، رد تماس اپراتورها را نیز در نظر می‌گیرد (رد تماس را پاسخ به تماس فرض می‌گیرد). این استراتژی نیز تماس‌ها را میان اپراتورها عادلانه تقسیم می‌کند، هرچند به‌خوبی روش تصادفی نیست.  

	- **RR Ordered**: همچون استراتژی `rrmemory` است، با این تفاوت که اولویت اپراتورها نیز در صف دخالت داده می‌شود.  

	- **Linear**: ارسال تماس به سمت اپراتورها بر اساس ترتیب مشخص‌شده است و همیشه از ابتدای لیست شروع می‌شود. فرض کنید شما تیمی دارید که در آن قرار است چند اپراتور بیشترین تماس را پاسخ دهند و دیگر اپراتورها زمانی که اپراتورهای اولیه مشغول‌اند، تماس را دریافت کنند. در این شرایط، این استراتژی به‌خوبی عمل می‌کند.  

	- **W Random**: تماس‌ها همانند استراتژی `Random` به‌صورت تصادفی به اپراتورها متصل می‌شوند، با این تفاوت که از مقدار `penalty` اپراتور در صف برای وزن‌دهی و انتخاب تصادفی استفاده می‌شود. بنابراین، اپراتوری که با پنالتی `1` وارد می‌شود، وزنی بین `0` تا `1000` به خود می‌گیرد. چنانچه با پنالتی `2` وارد شود، وزنی بین `0` تا `2000` و درصورتی‌که پنالتی `3` داشته باشد، وزنی بین `0` تا `3000` و الی‌آخر به خود می‌گیرد. از این وزن‌ها در انتخاب تصادفی استفاده می‌شود و احتمال انتخاب تصادفی بین اپراتورها تغییر می‌کند.

- **Ring InUse**: چنانچه `yes` باشد، تلفن کاربر در حین مکالمه نیز زنگ می‌خورد (پشت خطی).  

- **Call Record**: این گزینه تعیین‌کننده ضبط مکالمات در صف است.  

- **Set interface var**: چنانچه `yes` باشد، قبل از اینکه تماس به یک عضو صف متصل شود، متغیرهای زیر مقداردهی می‌شوند:  

	- **MEMBERINTERFACE**: نام رابط عضو صف (مثلاً `Agent/1234`).  

	- **MEMBERNAME**: نام عضو صف.  

	- **MEMBERCALLS**: تعداد تماس‌هایی که رابط کاربری گرفته است.  

	- **MEMBERLASTCALL**: آخرین زمانی که عضو صف تماس گرفته است.  

	- **MEMBERPENALTY**: مقدار `penalty` عضو صف.  

	- **MEMBERDYNAMIC**: نشان می‌دهد که یک عضو به‌صورت داینامیک به صف اضافه شده است یا خیر.  

	- **MEMBERREALTIME**: نشان می‌دهد که یک عضو صف کاربر `real-time` است یا خیر.

- **Autofill**: اگر `yes` به این گزینه داده شود و چند اپراتور هم در انتظار پاسخ‌گویی باشند، بسته به نوع استراتژی تعریف‌شده، سیستم هر تماسی را به یکی از اپراتورها وصل می‌کند تا زمانی که اپراتور آزاد شود یا تماسی در صف وجود نداشته باشد.  

- **Set Queue Var**: قبل از اینکه تماس به یک عضو صف متصل شود، متغیرهای زیر مقداردهی می‌شوند:  

	- **QUEUENAME**: نام صف.  

	- **QUEUEMAX**: حداکثر تعداد تماس‌های مجاز در صف.  

	- **QUEUESTRATEGY**: استراتژی صف.  

	- **QUEUECALLS**: تعداد تماس‌های فعال در صف.  

	- **QUEUEHOLDTIME**: میانگین زمان `hold` تماس‌گیرنده‌ها در صف.  

	- **QUEUECOMPLETED**: تعداد تماس‌های تکمیل‌شده برای صف.  

	- **QUEUEABANDONED**: تعداد تماس‌های رهاشده در صف.  

	- **QUEUESRVLEVEL**: سطح سرویس صف.  

	- **QUEUESRVLEVELPERF**: عملکرد سطح فعلی خدمات.

- **Set Queue Entry Var**: اگر `yes` انتخاب شود، قبل از اینکه تماس به یک عضو صف متصل شود، متغیرهای زیر مقداردهی می‌شوند:  

	- **QEHOLDTIME**: زمان انتظار تماس‌گیرندگان را نگه می‌دارد.  

	- **QEORIGINALPOS**: موقعیت اصلی تماس‌گیرنده در صف را نشان می‌دهد.  

- **PERSISTENT MEMBERS**: برای ذخیره اعضای اضافه‌شده به‌صورت پویا در صف‌ها استفاده می‌شود. اگر این گزینه روی `yes` تنظیم شود، اعضای صف پس از راه‌اندازی مجدد مرکز تماس، به‌طور خودکار مجدداً اضافه می‌شوند.

- **Shared Last Call**: این گزینه باعث می‌شود که آخرین تماس دریافت‌شده برای اعضایی که در بیش از یک صف وارد شده‌اند، یکسان باشد. این گزینه برای داخلی‌هایی که در بیش از یک صف عضو هستند، مفید است و باعث می‌شود بعد از هر تماس، از هر صفی که باشد، `wrapuptime` برای آن داخلی به ازای تمام صف‌هایی که عضو آن است، اعمال شود.  

- **Announce Hold Time**: اگر فعال باشد، آهنگ انتظار در صف پخش می‌شود.  

- **Announce Position**: اگر فعال باشد، سیستم موقعیت هر فرد را اعلام می‌کند.  

- **Join Empty**: تعیین می‌کند تماس‌ها به چه صورتی وارد صف شوند تا در صورت عدم تطابق، به `Failover Destination` هدایت شوند.  

	- **Yes**: همیشه اجازه می‌دهد تماس وارد صف شود. 

	- **No**: درصورتی‌که اپراتور فعالی وجود نداشته باشد، به تماس اجازه ورود به صف داده نمی‌شود.

- **Leave when Empty**: نحوه خارج شدن از صف را مشخص می‌کند.  

	- **Yes**: اگر اپراتور فعالی وجود نداشته باشد، تماس از صف خارج می‌شود.  

	- **No**: تا زمانی که زمان انتظار مکالمه در صف به پایان نرسد، هیچ تماسی از صف خارج نمی‌شود.  

- **Report Hold Time**: قبل از اتصال تماس به اپراتور، زمان انتظار تماس‌گیرنده را به اپراتور اعلام می‌کند. اگر این زمان کمتر از یک دقیقه باشد، اعلام نمی‌شود.

- **Max len**: حداکثر تعداد تماس‌هایی را مشخص می‌کند که می‌توانند در صف انتظار قرار گیرند. مقدار `0` به معنی نبود محدودیت است. چنانچه مقداری تعریف شود و تعداد تماس‌ها بیش از آن مقدار باشد، تماس‌ها به `Failover Destination` هدایت می‌شوند.  

- **Announce Frequency**: بازه زمانی‌ای را مشخص می‌کند که پیغام اعلام موقعیت تماس‌گیرنده در صف برای وی پخش می‌شود. برای مثال، با انتخاب عدد `۱۵`، هر `۱۵` ثانیه یک‌بار موقعیت تماس‌گیرنده در صف به وی اعلام می‌شود.  

- **Min Announce Frequency**: حداقل زمانی است میان اعلان‌های موقعیت/زمان که موجب می‌شود تماس‌گیرنده از دریافت پیام‌های متعدد در صف‌هایی که به‌سرعت در حال تغییر موقعیت/زمان هستند، در امان بماند.

- **Periodic Announce Frequency**: مشخص می‌کند که فایل‌های صوتی تعریف‌شده در چه بازه زمانی‌ای اجرا شوند.  

- **Music**: انتخاب آهنگ انتظار برای صف.  

- **Queue Calls Waiting**: پیامی که برای زمان انتظار تماس‌گیرندگان پخش می‌شود.  

- **Queue Thank You**: پیامی که برای تشکر از انتظار در صف پخش می‌شود.  

- **Queue There Are**: پیامی که مکان در صف را اعلام می‌کند.  

- **Queue You Are Next**: پیامی که به تماس‌گیرنده اعلام می‌کند که نفر بعدی در صف انتظار برای ارتباط با اپراتور است.  

- **Retry**: تعداد دفعاتی که سعی می‌کند تماس را به اپراتورهای دیگر وصل کند. اگر روی `no retry` تنظیم شود، تماس به‌محض نبود پاسخ، به `Failover Destination` هدایت می‌شود.

- **Service Level**: برای آمار سطح خدمات (تماس پاسخ‌داده‌شده در فریم زمان سطح خدمات) استفاده می‌شود. برای مثال، اگر `servicelevel = 60` باشد، هر `۶۰` ثانیه، تعداد تماس‌ها (برحسب موفق و ناموفق و یا ...) را برحسب درصد حساب می‌کند.  

- **Time out**: حداکثر زمان انتظار یک تماس در صف است که پس از آن، تماس به `Failover Destination` هدایت می‌شود.  

- **Weight**: این گزینه یک عدد را به‌عنوان اولویت برای صف تعیین می‌کند تا اگر کاربری در چندین صف عضویت داشته باشد، تماس ابتدا از صف با اولویت بالاتر به او وصل شود.  

- **Wrap-Up-Time**: این پارامتر زمانی را مشخص می‌کند که وقتی یک تماس توسط اپراتور پاسخ داده می‌شود، بعد از گذشت چند ثانیه، تماس بعدی به اپراتور وصل شود. این زمان درواقع مانند یک زمان استراحت است. این مقدار به‌صورت پیش‌فرض روی صفر تنظیم شده است، یعنی بعد از به پایان رسیدن تماس جاری، بلافاصله تماس بعدی وصل می‌شود.  

- **Monitor Type**: تنظیم کردن نوع ضبط مکالمات که به‌صورت پیش‌فرض `MixMonitor` است.  

- **Monitor Format**: فرمت ضبط مکالمات را تعیین می‌کند (`monitor-format = gsm | wav | wav49`).  

- **More Option**: اگر در تعریف صف قصد دارید از پارامتری استفاده کنید که در لیست بالا به آن اشاره نشده است، آن پارامتر و مقدارش را در این قسمت وارد کنید. اگر قصد دارید چندین پارامتر تعریف کنید، باید هرکدام را در یک خط وارد کنید.

## الگوی حضور کاربران در صف و قابلیت مپ‌شدن داخلی‌ها

یکی از قابلیت‌های منحصربه‌فرد سیموتل، امکان استفاده داینامیک یک داخلی از تلفن‌های مختلف است. لذا داخلی با استفاده از کدهای ویژه و بدون محدودیت مکانی، می‌تواند وارد صف گردد.

برای مثال فرض کنید در مکانی چهار دستگاه تلفن برای اپراتورها در نظر گرفته شده و برای هر یک به‌ترتیب داخلی‌های 1001، 1002، 1003 و 1004 رجیستر شده و برای اپراتورها نیز داخلی‌های 200 تا 220 تعریف شده باشد. این اپراتورها در شیفت‌های مختلفی قرار دارند و همگی باید از همین چهار دستگاه تلفن (بدون آنکه داخلی تنظیم‌شده برای آن را تغییر دهند) استفاده نمایند. ساده‌ترین روش استفاده آن است که اپراتور همیشه از یک تلفن منحصربه‌فرد استفاده نماید و در آینده با در نظر گرفتن ساعت حضور خود، لاگ‌های تماس مربوط به خود را پیدا کند. بدیهی است که در این روش، بررسی کارکرد اپراتورها سخت و خطاپذیر می‌باشد.

سیموتل با ارائه قابلیت مپ‌شدن (ورود و خروج داینامیک به صف)، این امکان را فراهم آورده است که اپراتورها بتوانند با استفاده از داخلی اختصاصی خود، با هرکدام از تلفن‌های موجود وارد صف شوند و به فعالیت خود ادامه دهند. برای استفاده از قابلیت مپ‌شدن، اپراتور باید با استفاده از کد ویژه ورود به صف (یا از طریق پنل) وارد صف شود. در روند ورود به صف، اپراتور ابتدا کد ویژه ورود به صف را شماره‌گیری و سپس داخلی خود را وارد می‌نماید و در نهایت وارد صف می‌شود. از این لحظه داخلی رجیستر شده روی گوشی به داخلی کاربر مپ می‌شود (برای مثال، فرض کنید در مثال قبل کاربر 210 قصد دارد از گوشی 1001 استفاده کند. او با داخلی خود از طریق گوشی 1001 وارد صف کاری خود می‌شود. عملیات مپ انجام و 1001 به 210 مپ می‌شود).

### مدیریت کاربران صف

**برای ورود و خروج کاربران به صف سه روش وجود دارد**

۱. **ورود و خروج به صف با کد ویژه**: در بخش کد ویژه توضیح داده شده است.  

۲. **ورود و خروج به صف از طریق پنل**: در مقابل هر صف (لیست صف‌ها) آیکون ورود و خروج به صف قرار داده شده است، با کلیک روی آن، پنجره ورود و خروج به صف باز می‌شود. در لیست بالایی پنجره فوق، کاربران حاضر در صف نمایش داده شده‌اند و از قسمت پایین اپراتورها وارد صف می‌شوند.  

۳. **ورود و خروج به صف از طریق وب‌سرویس**: توضیحات کامل در داکیومنت وب‌سرویس آورده شده است.  

### تخلیه صف‌ها

با استفاده از این قابلیت، تمام اعضا از صف‌ها خارج می‌شوند و برای ادامه فعالیت باید مجدداً وارد شوند.